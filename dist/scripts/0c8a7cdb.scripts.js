var bdysJson='{"bsbr08": {"pts": [[9.970634375109034, -84.16662862265946], [9.969907681451806, -84.16657379040629], [9.96918575418298, -84.16650864293284], [9.96943374126796, -84.16599287415393], [9.969851338243716, -84.16521112187816], [9.970192424609472, -84.1644953963647], [9.970381346368669, -84.16399504832715], [9.970414333758404, -84.16356338864574], [9.970860827824179, -84.16358807368938], [9.971522431696373, -84.1636944279533], [9.971865267262292, -84.16377292236123], [9.97160925842014, -84.16415504435048], [9.971549964164529, -84.1645948033377], [9.971502592657677, -84.16497758355433], [9.971482064948713, -84.16534208232451], [9.971453921969445, -84.1657601923639], [9.971431254046498, -84.16631665124032], [9.971410736324534, -84.1666766097517], [9.970634375109034, -84.16662862265946]]}, "bsbr06": {"pts": [[9.968973408638314, -84.16704810218715], [9.968834630162002, -84.16738249091311], [9.968687859338182, -84.16774137804002], [9.968576842974961, -84.16801182972485], [9.968357135937447, -84.16856601952634], [9.968235536849983, -84.1688600789591], [9.968290364601158, -84.1689382478004], [9.968185140827481, -84.16925035558872], [9.968071991033325, -84.16959979567874], [9.967896742305653, -84.17004978516898], [9.967619131169556, -84.1698935282033], [9.967423552934315, -84.16974591816535], [9.967035306551264, -84.16945708532839], [9.966685131806567, -84.16939843670873], [9.966378287697097, -84.1691726710474], [9.966023354857446, -84.16893273823939], [9.965734303225522, -84.16857025333104], [9.965613440668452, -84.16826787236042], [9.965819326733603, -84.16803068108251], [9.965957335661212, -84.16799686820771], [9.966182771570422, -84.16790301677798], [9.966307864428352, -84.16775732151905], [9.96656028368469, -84.16746657050498], [9.966602035273382, -84.1673851778044], [9.966674270744669, -84.16718030471891], [9.966646242740357, -84.16689545065421], [9.966659298405238, -84.16670404110766], [9.966688356310634, -84.16638654621703], [9.966646786420888, -84.1661875138058], [9.967314722075486, -84.16630549476103], [9.967907745506793, -84.16639133922605], [9.968658444907955, -84.16649284406267], [9.969173790522499, -84.16652434615186], [9.968973408638314, -84.16704810218715]]}}',data,bdys=JSON.parse(bdysJson);(function(e){e.userRoles={"public":1,user:2,admin:4},e.accessLevels={"public":7,anon:1,user:6,admin:4}})("undefined"==typeof exports?this.routingConfig={}:exports),function(){"use strict";var e,t,o,r,a,n=function(e,t){return function(){return e.apply(t,arguments)}};a=function(e){return e.lat+","+e.lng},r=function(e){var t;return t=e.split(","),{lat:t[0],lng:t[1]}},o=function(){function e(e,t,o){var r,a,i,l,s;for(this.map=e,this.pts=t,this.bdyData=o,this.click=n(this.click,this),this.show=n(this.show,this),this.gmaps=google.maps,this.coords=[],i=0,l=t.length;l>i;i++)a=t[i],this.coords.push(new this.gmaps.LatLng(a[0],a[1]));this.bdy=new this.gmaps.Polygon({paths:this.coords,strokeColor:"red",strokeOpacity:.8,strokeWeight:2,fillOpacity:0,clickable:!1}),r=this.map.mapTypeId||"hybrid",("cong"===(s=this.bdyData.typ)||"congArea"===s||"congAreaResidentialTerr"===s)&&this.bdy.setOptions(this.typOptions[this.bdyData.typ][r]),this.bdy.setMap(this.map)}return e.prototype.defaultOptions={normal:{fillColor:"blue",fillOpacity:0,strokeColor:"blue",strokeOpacity:.8,strokeWeight:2},hover:{fillOpacity:.1,strokeWeight:3}},e.prototype.typOptions={cong:{roadmap:{zIndex:4,fillColor:"black",fillOpacity:0,strokeColor:"black",strokeOpacity:.8,strokeWeight:3},hybrid:{zIndex:100,fillColor:"white",fillOpacity:0,strokeColor:"white",strokeOpacity:.8,strokeWeight:4},hover:{fillOpacity:.1,strokeWeight:3}},congArea:{roadmap:{zIndex:3,fillColor:"red",fillOpacity:0,strokeColor:"red",strokeOpacity:.8,strokeWeight:2},hybrid:{zIndex:103,fillColor:"red",fillOpacity:0,strokeColor:"red",strokeOpacity:.8,strokeWeight:3},hover:{fillOpacity:.1,strokeWeight:4}},congAreaResidentialTerr:{roadmap:{zIndex:0,fillColor:"blue",fillOpacity:0,strokeColor:"blue",strokeOpacity:.8,strokeWeight:2},hybrid:{zIndex:106,fillColor:"blue",fillOpacity:0,strokeColor:"blue",strokeOpacity:.8,strokeWeight:2},hover:{fillOpacity:.1,strokeWeight:3}}},e.prototype.render=function(){return console.log("render")},e.prototype.show=function(){},e.prototype.click=function(){return console.log("mkrClick")},e}(),e=function(){function e(e){this.onTypeChange=n(this.onTypeChange,this),this.onZoomChange=n(this.onZoomChange,this),this.updateLocation=n(this.updateLocation,this),this.onCenterChanged=n(this.onCenterChanged,this),this.resizeMapEl=n(this.resizeMapEl,this),this.onDragEnd=n(this.onDragEnd,this),this.setCenter=n(this.setCenter,this),this.onDragStart=n(this.onDragStart,this),this.removeMkrs=n(this.removeMkrs,this),this.addPlcMkr=n(this.addPlcMkr,this),this.addBdy=n(this.addBdy,this),this.onClick=n(this.onClick,this);var t;this.rootScope=e.rootScope,this.dragging=0,this.location=e.location,this.routeParams=e.routeParams,this.zoom=parseInt(this.location.search().z)||e.zoom,this.mapType=this.location.search().t||e.mapType,this.ll=this.location.search().ll||e.ll,this.center=this.ll?r(this.ll):e.center,this.routeParams.ll=this.ll,this.mapEl=$("#map"),this.mapTypes={m:"roadmap",h:"hybrid"},this.map=new google.maps.Map(this.mapEl[0],{zoom:this.zoom,visualRefresh:!0,center:new google.maps.LatLng(this.center.lat,this.center.lng),mapTypeId:this.mapTypes[this.mapType]}),t=google.maps.event.addListener,t(this.map,"center_changed",this.onCenterChanged),t(this.map,"maptypeid_changed",this.onTypeChange),t(this.map,"zoom_changed",this.onZoomChange),t(this.map,"dragstart",this.onDragStart),t(this.map,"dragend",this.onDragEnd),t(this.map,"click",this.onClick),this.rootScope.protocol=this.location.protocol(),this.rootScope.host=this.location.host(),this.rootScope.mapCenter=this.center,this.rootScope.mapZoom=this.zoom,this.rootScope.mapTypeId=this.mapTypeId}return e.prototype.onClick=function(e){var t,o;return console.log("onClick.@rootScope.selectedItemIndex",this.rootScope.selectedItemIndex),console.log("clicked at:",e,[e.latLng.lat(),e.latLng.lng()]),this.rootScope.selectedItemIndex>-1?(o=this.rootScope.selectedItem,o.pt=[e.latLng.lat(),e.latLng.lng()],this.addPlcMkr(this.map,o),t=JSON.stringify({actions:{$set:{flds:{pt:o.pt}}}}),o.patch(o._id,t),this.rootScope.selectedItemIndex=-1,this.rootScope.$$phase||this.rootScope.$apply()):void 0},e.prototype.addBdy=function(e,t){return new o(e,t.pts,t)},e.prototype.addPlcMkr=function(e,o){var r,a,n,i,l;return a=this.icon(o),i=o.pt[0],l=o.pt[1],r=!0,n={_id:o._id,id:o.id,mkrNo:o.mkrNo,dNam:o.dNam,patch:o.patch},new t(e,i,l,a,r,n)},e.prototype.removeMkrs=function(){return this.rootScope.items?angular.forEach(this.rootScope.items,function(e){return e.mapMkr?e.mapMkr.marker.setMap(null):void 0}):void 0},e.prototype.onDragStart=function(){return this.dragging=!0,!0},e.prototype.setCenter=function(){return console.log("setCenter",this.center)},e.prototype.onDragEnd=function(){return this.dragging=!1,this.onCenterChanged()},e.prototype.resizeMapEl=function(){},e.prototype.onCenterChanged=function(){var e;return e=this.map.getCenter(),this.center.lat=e.lat(),this.center.lng=e.lng(),this.dragging?void 0:(this.rootScope.mapCenter=this.center,this.ll=a(this.center),this.routeParams.ll=this.ll,this.updateLocation())},e.prototype.updateLocation=function(){return this.rootScope.$$phase||this.rootScope.$apply()},e.prototype.onZoomChange=function(){return this.rootScope.mapZoom=this.zoom=this.map.getZoom(),this.routeParams.z=this.zoom,this.updateLocation()},e.prototype.onTypeChange=function(){return this.mapTypeId=this.map.getMapTypeId(),this.rootScope.mapTypeId=this.mapTypeId[0],this.routeParams.t=this.mapTypeId[0],this.updateLocation()},e}(),t=function(){function e(e,t,o,r,a,i){this.map=e,this.lat=t,this.lng=o,this.icon=null!=r?r:null,this.draggable=null!=a?a:!0,this.itemData=null!=i?i:null,this.click=n(this.click,this),this.show=n(this.show,this),this.dragend=n(this.dragend,this),this.gmaps=google.maps,this.position=new this.gmaps.LatLng(this.lat,this.lng),this.marker=new this.gmaps.Marker({draggable:this.draggable,icon:this.icon}),this.gmaps.event.addListener(this.marker,"dragend",this.dragend),this.gmaps.event.addListener(this.marker,"click",this.click),this.marker.setPosition(this.position),this.marker.setMap(this.map)}return e.prototype.render=function(){return console.log("render"),this.show()},e.prototype.dragend=function(e){var t;return confirm("Are you sure you want to move this marker?")?(t=JSON.stringify({actions:{$set:{flds:{pt:[e.latLng.lat(),e.latLng.lng()]}}}}),this.itemData.patch(this.itemData._id,t)):this.marker.setPosition(this.position)},e.prototype.show=function(){return this.marker.setPosition(this.position),this.marker.setMap(this.map)},e.prototype.click=function(){return console.log("mkrClick")},e}(),angular.module("ofApp",["restangular","ngCookies","ui.bootstrap"]),angular.module("ofApp").config(["$httpProvider",function(e){return e.defaults.headers.common.Authorization="Basic admin@orgtec.com:xxxxxx",e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",e.defaults.headers.post["Content-Type"]}]),angular.module("ofApp").config(["RestangularProvider",function(e){return e.setBaseUrl("http://exi.xchg.com/api"),e.setListTypeIsArray(!1),e.setResponseExtractor(function(e,t,o){return"users"===o&&"getList"===t&&localStorage.setItem("lsuser",JSON.stringify(e._items[0])),e})}]),angular.module("ofApp").config(["$routeProvider","$locationProvider","$httpProvider",function(e,t,o){var r,a;return r=routingConfig.accessLevels,e.when("/plcs",{templateUrl:"views/plcs.html",controller:"PlcsCtrl",access:r.anon}),e.when("/plc/:id/edit",{templateUrl:"views/plc-form.html",controller:"PlcFormCtrl",access:r.anon}),e.when("/plc/insert",{templateUrl:"views/plc-form.html",controller:"PlcFormCtrl",access:r.anon}),e.when("/plc/:id",{templateUrl:"views/plc-view.html",controller:"PlcViewCtrl",access:r.anon}),e.when("/",{templateUrl:"views/partials/home.html",controller:"HomeCtrl",access:r.user}),e.when("/login",{templateUrl:"views/partials/login.html",controller:"LoginCtrl",access:r.anon}),e.when("/logout",{templateUrl:"views/partials/logout.html",controller:"LogoutCtrl",access:r.user}),e.when("/register",{templateUrl:"views/partials/register.html",controller:"RegisterCtrl",access:r.anon}),e.when("/private",{templateUrl:"/partials/private",controller:"PrivateCtrl",access:r.user}),e.when("/admin",{templateUrl:"/partials/admin",controller:"AdminCtrl",access:r.admin}),e.when("/404",{templateUrl:"views/partials/404.html",access:r["public"]}),e.otherwise({redirectTo:"/404"}),a=["$location","$q",function(e,t){var o,r;return r=function(e){return e},o=function(o){return 401===o.status?(e.path("/login"),t.reject(o)):t.reject(o)},function(e){return e.then(r,o)}}],o.responseInterceptors.push(a)}]),a=function(e){return e.lat+","+e.lng},r=function(e){var t;return t=e.split(","),{lat:t[0],lng:t[1]}},angular.module("ofApp").factory("GoogleMap",["$rootScope","$location","$routeParams",function(t,o,r){var n,i,l,s,c;return i={lat:9.993552791991132,lng:-84.20888416469096},n={lat:9.971365509675179,lng:-84.16658163070679},l=n,s=16,c={rootScope:t,location:o,routeParams:r,zoom:s,mapType:"h",ll:a(l),center:{lat:l.lat,lng:l.lng}},new e(c)}]),angular.module("ofApp").run(["$rootScope","$location","$routeParams","Auth",function(e,t,o,r){return e.currBdy={},e.title="",e.$on("$routeChangeSuccess",function(){return e.currPath=t.$$path,e.title=t.$$search.title}),e.$on("$routeChangeStart",function(o,a){return e.error=null,(r.authorize(a.access)?void 0:r.isLoggedIn())?void 0:t.path("/login")}),e.appInitialized=!0}])}.call(this),function(){"use strict";angular.module("ofApp").factory("Auth",["Restangular","$http","$rootScope","$cookieStore",function(e,t,o){var r,a;return r=routingConfig.accessLevels,a=routingConfig.userRoles,localStorage.getItem("lsuser")&&(o.user=JSON.parse(localStorage.getItem("lsuser"))),o.accessLevels=r,o.userRoles=a,{authorize:function(e,t){return void 0!==t?!0:!1},isLoggedIn:function(e){return void 0===e?e=o.user:void 0},register:function(e,o,r){return t.post("/register",e).success(o).error(r)},login:function(t,r){var a;return a=e.all("users"),a.getList({where:JSON.stringify({uNam:t.username})}).then(function(e){return e._items.length?(t=e._items[0],o.user=t,r(t)):void 0},function(){return $location.path("/")},function(){return o.error="Failed to login"})},logout:function(e,r){return t.post("/logout").success(function(){return o.user.uNam="",e()}).error(r)},accessLevels:r,userRoles:a}}])}.call(this),angular.module("ofApp").controller("AppCtrl",["$rootScope","$scope","$location","Auth",function(e,t,o,r){t.getUserRoleText=function(e){return _.invert(r.userRoles)[e]},t.logout=function(){r.logout(function(){o.path("/login")},function(){e.error="Failed to logout"})}}]),angular.module("ofApp").controller("LoginCtrl",["$rootScope","$scope","$location","Auth",function(e,t,o,r){e.activeNavItem="login",t.rememberme=!0,t.login=function(){localStorage.removeItem("lsuser"),r.login({username:t.username,password:t.password,rememberme:t.rememberme},function(){o.path("/")},function(){e.error="Failed to login"})}}]),angular.module("ofApp").controller("LogoutCtrl",["$rootScope","$location",function(e,t){localStorage.removeItem("lsuser"),delete e.user,t.path("/")}]),angular.module("ofApp").controller("HomeCtrl",["$rootScope",function(e){e.activeNavItem="home"}]),angular.module("ofApp").controller("RegisterCtrl",["$rootScope","$scope","$location","Auth",function(e,t,o,r){e.activeNavItem="register",t.role=routingConfig.userRoles.user,t.register=function(){r.register({username:t.username,password:t.password,role:t.role},function(t){e.user=t,o.path("/")},function(t){e.error=t})}}]),angular.module("ofApp").controller("PrivateCtrl",["$rootScope",function(e){e.activeNavItem="private"}]),angular.module("ofApp").controller("AdminCtrl",["$rootScope","$scope","Users",function(e,t,o){e.activeNavItem="admin",t.loading=!0,o.getAll(function(e){t.users=e,t.loading=!1},function(){e.error="Failed to fetch users.",t.loading=!1})}]),angular.module("ofApp").directive("accessLevel",["$rootScope","Auth",function(e,t){return{restrict:"A",link:function(o,r,a){var n=r.css("display");e.$watch("user.role",function(){t.authorize(a.accessLevel)?r.css("display",n):r.css("display","none")})}}}]).directive("autoFillableField",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,o,r){setInterval(function(){""===t.val()&&r.$pristine||e.$apply(function(){r.$setViewValue(t.val())})},300)}}}),angular.module("ofApp").controller("MainCtrl",["$scope","Restangular",function(e,t){var o=t.all("plcs");e.plcs=o.getList()}]),function(){"use strict";var e,t,o,r,a,n=[].indexOf||function(e){for(var t=0,o=this.length;o>t;t++)if(t in this&&this[t]===e)return t;return-1};t=function(e){return e.lat+","+e.lng},e=function(e){var t;return t=e.split(","),{lat:t[0],lng:t[1]}},a="img/map/sprites/",o="img/map/markers/small/white/numbers/",r=19,angular.module("ofApp").controller("PlcsCtrl",["$rootScope","$scope","$location","$routeParams","$cookies","Restangular","$timeout","$log","$anchorScroll","GoogleMap",function(n,i,l,s,c,d,p,u,m,h){var g,f,y,b,v,w,I;return b=h,v=google.maps,w=b.map,y={ll:"9.971365509675179,-84.16658163070679",cngSlug:"crherbs",cngAreaSlug:"br",cngAreaTerrSlug:"brr06",q:"",sort:"bdry,w",filter:"filtBdyId:crherbs",z:17,pp:5,pg:5},i.items=[],i.lastItemsWithInfo=null,i.maxId=null,i.q=s.q||y.q,i.ll=s.ll||y.ll,i.z=parseInt(s.z,10)||y.z,i.pp=s.pp||y.pp,i.pg=s.pg||y.pg,i.sort=s.sort||y.sort,i.media=s.media||"",n.printView=i.printView="prn"===s.media,i.args=y,n.filtBdyId=i.filtBdyId=null,n.editingBdy=!1,n.bdysLoaded=!1,n.selectedItemIndex=b.selectedItem=b.selectedItemIndex=-1,i.bdyViews={crherbs:[{nam:"Main",zoom:14,llCenter:"9.976819295953407,-84.16194130521517",mapTypeId:"hybrid"}],crherbsbr:[{nam:"Main",zoom:15,llCenter:"9.971071018203258,-84.15988136869173",mapTypeId:"hybrid"}],crherbsbrr01:[{nam:"Main",zoom:17,llCenter:"9.973437968382253,-84.16134049039584",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]}],crherbsbrr02:[{nam:"Main",zoom:17,llCenter:"9.97349638016292,-84.16631358847928",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]}],crherbsbrr03:[{nam:"Main",zoom:18,llCenter:"9.973667700855833,-84.16967939293744",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]}],crherbsbrr04:[{nam:"Main",zoom:18,llCenter:"9.971095930944049,-84.16924278118506",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]}],crherbsbrr05:[{nam:"Main",zoom:18,llCenter:"9.97113872118877,-84.16887763435983",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]}],crherbsbrr06:[{nam:"Main",zoom:18,llCenter:"9.96906003005786,-84.16883676999466",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]},{nam:"E",zoom:19,llCenter:"9.969028329520771,-84.16865974419967",mapTypeId:"hybrid"},{nam:"W",zoom:19,llCenter:"9.969178907047947,-84.16866779082672",mapTypeId:"hybrid"}],crherbsbrr07:[{nam:"Main",zoom:18,llCenter:"9.967435883191067,-84.16807573414316",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]}],crherbsbrr08:[{nam:"Main",zoom:18,llCenter:"9.967593806754337,-84.16492581199572",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]}],crherbsbrr09:[{nam:"Main",zoom:18,llCenter:"9.969137449721174,-84.16503919625961",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]},{nam:"NE",zoom:19,llCenter:"9.969412187521936,-84.1647307422229",mapTypeId:"hybrid"},{nam:"SW",zoom:19,llCenter:"9.968801952286398,-84.1655944135257",mapTypeId:"hybrid"}],crherbsbrr10:[{nam:"Main",zoom:18,llCenter:"9.970525510722636,-84.16511999919874",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]},{nam:"NW",zoom:19,llCenter:"9.970512302225993,-84.1655813391493",mapTypeId:"hybrid"},{nam:"E",zoom:19,llCenter:"9.970916482013722,-84.16447090461713",mapTypeId:"hybrid"}],crherbsbrr11:[{nam:"Main",zoom:18,llCenter:"9.970053746032534,-84.16725222757447",mapTypeId:"hybrid",notes:[{title:"Direcciónes a este territorio",note:"saliendo del Salon del Reino de los Testigos de Jehovah, dobla  a la derecha y continuar al sur 600 mtrs, al final de la calle dobla a la izquierda,  en el primer semaforo dobla a la derecha, continuar hasta que llegar a la entradad de Bosques de Dona Rosa y entrar doblando a la derecha, coja la proxima derecha y la primera casa esta 100 metros mano izquierda"}]},{nam:"N",zoom:19,llCenter:"9.970510760384416,-84.16725222757447",mapTypeId:"hybrid"},{nam:"S",zoom:19,llCenter:"9.969612581282494,-84.16717712572205",mapTypeId:"hybrid"}]},g=d.all("bdys"),f=d.all("plcs"),s.sort||(s.sort=y.sort),n.returnRoute=l.$$url,i.location=l,i.routeParams=s,n.filtBdyId=i.filtBdyId=s.filtBdyId,console.log("filtBdyId",n.filtBdyId),n.$watch("selectedItemIndex",function(e){return i.selectedItem=n.selectedItem,n.selectedItemIndex=i.selectedItemIndex=e}),i.togglePrintView=function(){return n.printView=i.printView=!i.printView,i.printView?(console.log("PrintView Set On"),l.search("media","prn")):(console.log("PrintView Set On"),l.search("media",""))},b.icon=function(e){return i.printView?i.mkrIcon2(e.mkrNo,e.mkrState):i.mkrIcon(e.mkrNo,e.mkrState)},i.itemMkrClick=function(e){var o;return n.selectedItemIndex=b.selectedItemIndex=i.selectedItemIndex=e,n.selectedItem=b.selectedItem=i.items[e],w.setZoom(r),i.items[e].pt&&(n.selectedItemIndex=b.selectedItemIndex=i.selectedItemIndex=-1,o=i.items[e].pt,i.ll=t(o),w.setCenter(new google.maps.LatLng(o[0],o[1]))),l.hash("top"),m()},i.doSearch=function(){var e,t,o,r,a,c,d;if(!n.editingBdy&&(b.removeMkrs(),("boolean"!=typeof s.filtBdyId&&s.filtBdyId||i.q)&&("boolean"!=typeof s.filtBdyId||i.q))){if(e={},a=i.q,d={},"boolean"!=typeof s.filtBdyId&&s.filtBdyId&&(d.bdry=s.filtBdyId),c=a.match(/qp\w+/g)){for(r=[],o=0;c.length>o;)console.log(c[o]),r.push(c[o].substr(2)),++o;d.id={$in:r},a=a.replace(/qp\w+\s*/g,"")}return a&&(d.dNam={$regex:a,$options:"i"}),d&&(e.where=JSON.stringify(d)),s.sort&&(e.sort=s.sort),f.getList(e).then(function(e){var t,r,a,c,d;for(r=1,d=e._items,o=a=0,c=d.length;c>a;o=++a)t=d[o],e._items[o].patch=i.patch,delete e._items[o].mkrNo,"ref"!==t.typ&&(e._items[o].mkrNo=r,r+=1),t.pt&&parseInt(s.z,10)>16&&(e._items[o].mapMkr=b.addPlcMkr(w,t));return n.items=i.items=e._items,i.bdy=i.bdyViews[t.bdry][0],i.bdy.totalDoors=r-1,i.q?l.search("q",i.q):void 0},t=function(){return console.log("Oops error from server :(")})}},i.saveBdy=function(e){var t;return t=n.bdys[e],t.poly.setEditable(!1),n.editingBdy=i.editingBdy=!1},i.editBdy=function(e){var t;return console.log("editBdy key:",e),t=n.bdys[e],t.poly.setEditable(!0),n.editingBdy=i.editingBdy=!0},i.showBdyLabels=function(){var e,t,o,r,a,n,l,s,c,d,p,u;p=i.bdys,u=[];for(l in p)e=p[l],n=e.zoom,"congAreaResidentialTerr"===e.typ?(s="#98F5FF",t=12,o=e.nam.split("#")[1],n=15,a=17,d=100009):"congArea"===e.typ?(s="#FF82AB",t=16,o=e.nam,n=14,a=17,d=100019):"cong"===e.typ?(s="white",t=25,o=e.nam,n=13,a=17,d=100029):(s="white",t=20,o=e.nam,n=1,a=20,d=1e3),r=new MapLabel({minZoom:n,maxZoom:a,strokeColor:s,text:o,position:new google.maps.LatLng(e.ptCenter[0],e.ptCenter[1]),map:w,fontSize:t,zIndex:d}),u.push(c=0);return u},i.loadBdys=function(){var e;return g.getList({sort:"typ,slug"}).then(function(e){var t,o,r,a,n,l,s,c;for(o={},r=[],c=e._items,a=l=0,s=c.length;s>l;a=++l)n=c[a],t={slug:n.slug,nam:n.nam,typ:n.typ,ptCenter:[n.ptCenter[0],n.ptCenter[1]],zoom:18,mapTypeId:"hybrid"},t.zoom="congAreaResidentialTerr"===n.typ?18:"congArea"===n.typ?15:"cong"===n.typ?14:12,o[n.slug]=t,r.push({slug:n.slug,nam:n.nam});return i.bdys=o,i.filtBdys=r,i.showBdyLabels()},e=function(){return console.log("Oops error from server :(")})},i.loadBdyPolys=function(){var e;return g.getList().then(function(e){var t,o,r,a,i,l,s;for(o={},s=e._items,r=i=0,l=s.length;l>i;r=++i)a=s[r],t=a,t.bdyPoly=b.addBdy(w,t),o[a.slug]=t;return n.bdysLoaded=!0},e=function(){return console.log("Oops error from server :(")})},i.patch=function(e,t){var o,r;return o=d.one("plcs",e),o.customPUT(null,null,null,t).then(function(){return console.log("success!")},r=function(){return console.log("Oops error from server :(")})},i.$watch("z",function(e){return l.search("z",e),i.z=parseInt(e,10)}),i.$watch("filtBdyId",function(t){var o,r,a;return l.search("filtBdyId",t),n.filtBdyId=i.filtBdyId=t,o="",t&&"string"==typeof t&&s.filtBdyId!==t?(o=i.bdys[t],a=o.ptCenter,w.setCenter(new google.maps.LatLng(a[0],a[1])),r=e(i.bdyViews[t][0].llCenter),w.setCenter(new google.maps.LatLng(r.lat,r.lng)),w.setZoom(i.bdyViews[t][0].zoom),w.setZoom(o.zoom),w.setMapTypeId(o.mapTypeId),n.filtBdyId=i.filtBdyId=t,s.filtBdyId=t,n.title=i.title=s.title=o.nam,console.log("newValue inside",t,o.nam)):s.filtBdyId!==t?(console.log("newValue",""),n.title=i.title="",s.title=""):void 0}),i.$watch("routeParams",function(e){return n.editingBdy?void 0:angular.forEach(e,function(e,t){return"where"!==t?(i[t]=e,l.search(t,e)):void 0})},!0),I={},i.doClear=function(){return i.q=i.location.q=i.routeParams.q=y.q,i.doSearch()},i.moveDown=function(e){var t,o,r,a,n,l,s;return(o=confirm("Move Down?"))?(n=i.items[e],l=i.items[e+1],s=0===e?n.w-1.00000001:n.w-(n.w-i.items[e-1].w)/2,r=JSON.stringify({actions:{$set:{flds:{w:s}}}}),t=d.one("plcs",l._id),t.customPUT(null,null,null,r).then(function(){return i.doSearch()},a=function(){return console.log("Oops error from server :(")})):void 0},i.moveUp=function(e){var t,o,r,a,n,l,s;return(o=confirm("Move up?"))?void 0:(n=i.items[e],l=i.items[e-1],s=e===i.items.length-1?n.w+1.00000001:0===e?n.w-1.00000001:n.w+(i.items[e+1].w-n.w)/2,r=JSON.stringify({actions:{$set:{flds:{w:s}}}}),t=d.one("plcs",l._id),t.customPUT(null,null,null,r).then(function(){return i.doSearch()},a=function(){return console.log("Oops error from server :(")}))},i.insertAfter=function(e){var t,o,r,a;return(o=confirm("Insert a new place?"))?(a=i.items[e],t={nam:"Nuevo lugar en blanco.",bdry:a.bdry},t.w=e===i.items.length-1?a.w+1.00000001:a.w+(i.items[e+1].w-a.w)/2,r="doc="+JSON.stringify(t),f=d.all("plcs"),f.post(r).then(function(){return i.doSearch()})):void 0},i.add=function(){var e;return e="doc="+JSON.stringify(i.newItem),f=d.all("plcs"),f.post(e).then(function(e){return i.newItem._id=e.doc._id,i.items.push(i.newItem),i.newItem={}})},i.remove=function(e){var t,o,r,a;return o=confirm("Are you absolutely sure you want to delete?"),o?(a=i.items[e],t=d.one("plcs",a._id),t.remove().then(function(){return i.doSearch()},r=function(){return console.log("Oops error from server :("),l.path("/plc/"+s.id)})):void 0},i.insert=function(){return l.path("/plc/insert")},i.edit=function(e){var t;return t=i.items[e],l.path("/plc/"+t._id+"/edit")},i.view=function(e){var t;return t=i.items[e],l.path("/plc/"+t._id)},i.mkrIcon=function(e,t){var o,r,n,i,l,s,c;return null==t&&(t=0),i=["new","try_1","try_1_contacted","try_2","try_2_contacted","try_3","try_3_contacted"],r=12,n=null,l=null,s=null,c=null,10>e?(l=a+"sprite_1.png",n=12,s=(e-1)*n,c=t*r):100>e?(l=a+"sprite_2.png",n=14,s=(e-10)*n,c=t*r):(l=a+"sprite_3.png",n=18,s=(e-100)*n,c=t*r),c&&(c+=1),e&&t>-1&&(o=new google.maps.MarkerImage(l,new google.maps.Size(n,12),new google.maps.Point(s,c),new google.maps.Point(n/2,r/2))),o},i.mkrIcon2=function(e,t){var r,a,n,i;return null==t&&(t=0),a=o+e+".png",n=12,i=10>e?12:100>e?14:20,r=new google.maps.MarkerImage(a,new google.maps.Size(i,n),new google.maps.Point(0,0))},i.loadBdys(),i.doSearch(),i.loadBdyPolys()}]),angular.module("ofApp").controller("PlcFormCtrl",["$rootScope","$scope","$location","$routeParams","Restangular",function(e,t,o,r,a){var n,i,l;return l="/plc/insert"===o.$$path,l?t.mode="Add New":(t.mode="Update",n=a.one("plcs",r.id),n.get().then(function(e){return t.dNam=e.dNam,t.item={},t.item._id=e._id||null,t.item.bdry=e.bdry||"",t.item.nam=e.nam||"",t.item.namS=e.namS||"",t.item.typ=e.typ||"",t.item.addr=e.addr,t.item.desc=e.desc,t.item.w=e.w,t.item.tags=void 0!==e.tags?e.tags.join(","):"",void 0!==e.pt?(t.item.lng=e.pt[0],t.item.lat=e.pt[1]):void 0},i=function(){return console.log("Oops error from server :(")})),t.remove=function(e){var t;return t=confirm("Are you absolutely sure you want to delete?"),t?(n=a.one("plcs",e._id),n.remove().then(function(){return o.path("/plcs")},i=function(){return console.log("Oops error from server :("),o.path("/plc/"+r.id)})):void 0},t.save=function(t){var o,r;return r={},console.log("save"),l?(r="doc="+JSON.stringify(t),o=a.all("plcs"),o.post(r).then(function(){return window.location.href="#"+e.returnRoute},i=function(){return console.log("Oops error from server :(")})):(t.tags=void 0!==t.tags&&t.tags>""?t.tags.split(","):[],"ref"===t.typ&&(t.pt=[]),delete t.lat,delete t.lng,delete t._id,t.w+=1e-9,r=JSON.stringify({actions:{$set:{flds:t}}}),n.customPUT(null,null,null,r).then(function(){return window.location.href="#"+e.returnRoute},i=function(){return console.log("Oops error from server :(")}))},t.abandonChanges=function(){return o.path("/plc/"+t.item._id)}}]),angular.module("ofApp").controller("PlcViewCtrl",["$rootScope","$scope","$location","$routeParams","Restangular",function(e,t,o,r,a){var i,l;return i=a.one("plcs",r.id),i.get().then(function(e){return t.item=e,n.call(e,"pt")>=0?(t.lng=e.pt[0],t.lat=e.pt[1]):void 0},l=function(){return console.log("Oops error from server :(")}),t.remove=function(t){var o;return o=confirm("Are you absolutely sure you want to delete?"),o?(i=a.one("plcs",t._id),i.remove().then(function(){return window.location.href="#"+e.returnRoute},l=function(){return console.log("Oops error from server :("),window.location.href="#"+e.returnRoute})):void 0},t.edit=function(e){return o.path("/plc/"+e._id+"/edit")}}])}.call(this);